<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8">
        <link rel="stylesheet" type="text/css" href="sas.css"/>
        <title>OpenSearch Security Audit Logs</title>
    </head>
    <body>
        <h1 id="139641630293056opensearch-security-audit-logs">OpenSearch Security Audit Logs</h1>
<h2 id="139641630293056overview">Overview</h2>
<p>Security audit logs track a range of OpenSearch cluster events. The OpenSearch audit logs can provide beneficial information for compliance purposes or assist in the aftermath of a security breach.</p>
<p>The audit logs are written to audit indices in the OpenSearch cluster. Audit indices can build up over time and use valuable resources. By default, an Index State Management (ISM) policy named &lsquo;viya_delete_old_security_audit_logs&rsquo; is applied by the operator which deletes security audit log indices after seven days with an ISM priority of 50. OpenSearch enables ISM history logs, which are also stored to new indices. By default, ISM history retention is seven days. </p>
<p>The ISM policy can be disabled or configured to retain OpenSearch audit log indices for a specified length of time. </p>
<p>If you have already manually created an ISM policy for OpenSearch audit logs, the policy with the higher priority value will take precedence. </p>
<h2 id="139641630293056configure-the-viya_delete_old_security_audit_logs-ism-policy">Configure the viya_delete_old_security_audit_logs ISM policy</h2>
<h3 id="139641630293056configurable-parameters">Configurable Parameters</h3>
<table>
<thead>
<tr>
<th>Configurable Parameter</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td>enableIndexCleanup</td>
<td>Apply the ISM policy to remove OpenSearch security audit log indices after the length of time specified in <em>indexRetentionPeriod</em>. If you want to retain the indices indefinitely, set to &ldquo;false&rdquo;. <br> <strong>Note</strong>: In order to prevent performance issues, SAS recommends that you change the <em>indexRetentionPeriod</em> to a higher period rather than disabling index cleanup.</td>
<td>true</td>
</tr>
<tr>
<td>indexRetentionPeriod</td>
<td>Period of time an OpenSearch audit log is retained for if the ISM policy is applied. Supported units are <em>d</em> (days), <em>h</em> (hours), <em>m</em> (minutes), <em>s</em> (seconds), <em>ms</em> (milliseconds), and <em>micros</em> (microseconds).</td>
<td>7d</td>
</tr>
<tr>
<td>ismPriority</td>
<td>A priority to disambiguate when multiple policies match an index name. OpenSearch takes the settings from the template with the highest priority and applies it to the index.</td>
<td>50</td>
</tr>
<tr>
<td>enableISMPolicyHistory</td>
<td>Additional indices are also created to log ISM history data. Specifies whether ISM audit history is enabled or not.</td>
<td>true</td>
</tr>
<tr>
<td>ismLogRetentionPeriod</td>
<td>Period of time ISM history indices are kept if they are enabled. Supported units are <em>d</em> (days), <em>h</em> (hours), <em>m</em> (minutes), <em>s</em> (seconds), <em>ms</em> (milliseconds), and <em>micros</em> (microseconds).</td>
<td>7d</td>
</tr>
</tbody>
</table>
<h3 id="139641630293056configuration-instructions">Configuration Instructions</h3>
<ol>
<li>
<p>Copy the audit log retention transformer from <code>$deploy/sas-bases/examples/configure-elasticsearch/internal/security-audit-logs/audit-log-retention-transformer.yaml</code> into the <code>$deploy/site-config</code> directory. Adjust the value for each parameter listed above that you would like to change. </p>
</li>
<li>
<p>Add the audit-log-retention-transformer.yaml file to the transformers block of the base kustomization.yaml file (<code>$deploy/kustomization.yaml</code>). Here is an example:</p>
<pre class="highlight"><code class="language-yaml">transformers:
...
- site-config/audit-log-retention-transformer.yaml</code></pre>

</li>
</ol>
<p><strong>Note</strong>: The ISM policy values can be adjusted and reconfigured after the initial deployment.</p>
<h2 id="139641630293056disable-security-audit-logs">Disable Security Audit Logs</h2>
<p>OpenSearch security audit logging can be disabled completely.</p>
<ol>
<li>
<p>Copy the disable security audit transformer from <code>$deploy/sas-bases/examples/configure-elasticsearch/internal/security-audit-logs/disable-security-audit-transformer.yaml</code> into the <code>$deploy/site-config</code> directory.</p>
</li>
<li>
<p>Add the disable-security-audit-transformer.yaml file to the transformers block of the base kustomization.yaml file (<code>$deploy/kustomization.yaml</code>). Here is an example:</p>
<pre class="highlight"><code class="language-yaml">transformers:
...
- site-config/disable-security-audit-transformer.yaml</code></pre>

</li>
</ol>
<h2 id="139641630293056additional-resources">Additional Resources</h2>
<p>For more information on OpenSearch audit logs or Index State Management (ISM) policies, see the <a href="https://opensearch.org/docs/latest/">OpenSearch Documentation</a>.</p>
    </body>
</html>